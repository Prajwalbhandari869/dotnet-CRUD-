@page "/trackpages/trackviewallpage"

@inject NavigationManager _nav
@inject ITrackServices _trackServices
<div>
    <div style="display:inline-flex">
        <div style="margin-right:80px;">
            <h3>TracksList</h3>
        </div>
        <div>
            <input type="button" class="btn btn-primary" @onclick="@AddTrack" value="Add Track" />
        </div>
    </div>
    <div class="col-md-6">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Rating</th>
                    <th>Length</th>
                    <th>Album</th>
                    <th>Genre</th>
                </tr>
            </thead>
            @if (@tracks.Any())
            {
                <tbody>
                    @foreach (var track in tracks)
                    {
                        TimeSpan time = TimeSpan.FromSeconds(@track.Length);
                        string timeStr = time.ToString();
                        int count = track.Rating;
                        <tr class="change" style="cursor:pointer" onclick="@(()=>GoToTrackDetails(track.Id))">
                            <td style="color:blueviolet">@track.Title</td>
                            <td>
                                @for (var i = 1; i <= 5; i++)
                                {
                                    if (i <= count)
                                    {
                                        <i class="fa fa-star" style="color:blue"></i>
                                    }
                                    else
                                    {
                                        <i class="fa fa-star" style="color:purple"></i>
                                    }
                                }
                            </td>
                            <td>@timeStr</td>
                            <td>@track.AlbumTitle</td>
                            <td>@track.GenreName</td>
                        </tr>
                    }
                </tbody>
            }
        </table>
    </div>
</div>
<style>
    .change:hover {
        transform: scale(1.05,1.05);
        transition-duration: 500ms;
        transition-timing-function: ease-out;
    }

    .change {
        transform: scale(1,1);
        transition-duration: 500ms;
        transition-timing-function: ease-out;
    }
</style>
@code {
    List<ViewAllTrack> tracks = new List<ViewAllTrack>();
    protected override async Task OnInitializedAsync()
    {
        tracks = (await _trackServices.GetAllTrackAsync()).ToList();
    }
    protected void AddTrack()
    {
        _nav.NavigateTo("/trackpages/trackcreatepage");
    }
    protected void GoToTrackDetails(int id)
    {
        _nav.NavigateTo($"/trackpages/trackviewpage/{id}");
    }
}
